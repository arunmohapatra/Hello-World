import java.io.*;
import java.nio.file.*;
import java.util.*;

public class AccessibleRolls {

    public static void main(String[] args) {

        String filePath = "input.txt";  // fixed input source
        List<String> lines;

        try {
            lines = Files.readAllLines(Paths.get(filePath));
        } catch (IOException e) {
            System.out.println("Error reading input.txt: " + e.getMessage());
            return;
        }

        int rows = lines.size();
        int cols = lines.get(0).length();
        char[][] grid = new char[rows][cols];

        for (int i = 0; i < rows; i++) {
            grid[i] = lines.get(i).toCharArray();
        }

        int[] dx = {-1,-1,-1,0,0,1,1,1};
        int[] dy = {-1,0,1,-1,1,-1,0,1};

        int totalRemoved = 0;

        while (true) {
            List<int[]> toRemove = new ArrayList<>();

            // Find all currently accessible rolls
            for (int r = 0; r < rows; r++) {
                for (int c = 0; c < cols; c++) {

                    if (grid[r][c] != '@') continue;

                    int neighbours = 0;

                    for (int k = 0; k < 8; k++) {
                        int nr = r + dx[k];
                        int nc = c + dy[k];

                        if (nr >= 0 && nr < rows && nc >= 0 && nc < cols) {
                            if (grid[nr][nc] == '@') {
                                neighbours++;
                            }
                        }
                    }

                    if (neighbours < 4) {
                        toRemove.add(new int[]{r, c});
                    }
                }
            }

            // If nothing can be removed â†’ stop
            if (toRemove.isEmpty()) break;

            // Remove all accessible rolls
            for (int[] pos : toRemove) {
                int r = pos[0], c = pos[1];
                grid[r][c] = '.';
            }

            totalRemoved += toRemove.size();
        }

        System.out.println("Total rolls removed: " + totalRemoved);
    }
}
